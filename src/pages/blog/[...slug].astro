---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';

export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  return blogEntries.map(entry => ({
    params: { slug: entry.slug }, props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content, remarkPluginFrontmatter } = await entry.render();

// JSON-LD dla tego konkretnego artykułu
const jsonLd = {
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": entry.data.title,
  "description": entry.data.description,
  "image": `https://raporty24.pl${entry.data.image}`,
  "datePublished": entry.data.pubDate.toISOString(),
  "author": {
    "@type": "Person",
    "name": entry.data.author,
    "url": "https://raporty24.pl/#dlaczego"
  }
};
---

<BaseLayout title={entry.data.title} description={entry.data.description}>
  <script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />

  <Header />
  
  <article class="py-24 bg-white">
    <div class="container mx-auto px-4 max-w-3xl">
      <header class="mb-12">
        <div class="flex items-center gap-3 text-sm mb-6">
           <span class="eyebrow !mb-0">{entry.data.category}</span>
           <span class="text-slate-300">•</span>
           <time class="text-slate-400">{entry.data.pubDate.toLocaleDateString('pl-PL')}</time>
        </div>
        <h1 class="display-title mb-8">{entry.data.title}</h1>
      </header>

      <div class="prose prose-lg prose-slate prose-headings:scroll-mt-28 prose-a:text-green-600 max-w-none">
        <Content />
      </div>

      <div class="mt-16 pt-8 border-t border-slate-100 flex gap-2">
        {entry.data.tags?.map(tag => (
          <span class="text-xs font-bold text-slate-400 uppercase tracking-widest">#{tag}</span>
        ))}
      </div>
    </div>
  </article>

<Footer />
  
  <script is:inline async src="https://www.tiktok.com/embed.js"></script>
</BaseLayout>