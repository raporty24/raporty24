---
// Panels.astro - Wersja Premium Glass z SEO Boosterem
---
<section id="oferta" class="modern-services relative overflow-hidden" x-data="{ activeStep: 0 }">
  
  <div class="sr-only">
    <h2>Ekspert Excel i Power BI Katowice – Oferta i Cennik</h2>
    <p>Świadczymy specjalistyczne usługi: tworzenie arkuszy Excel na zamówienie, naprawa uszkodzonych plików, wdrażanie zaawansowanych systemów Power BI oraz pełna automatyzacja raportów biznesowych dla firm ze Śląska.</p>
  </div>

  <div class="container mx-auto px-4 relative z-10">
    
    <header class="max-w-3xl mb-16 lg:mb-24">
      <div class="inline-flex items-center gap-2 mb-4 px-3 py-1 rounded-full bg-green-500/10 border border-green-500/20">
        <span class="text-[10px] font-black uppercase tracking-[0.2em] text-green-600">Full Service BI</span>
      </div>
      <h2 class="text-4xl lg:text-6xl font-black tracking-tighter text-slate-900 mb-8 leading-tight">
        Raportowanie, które <span class="text-green-600">pracuje na Ciebie.</span>
      </h2>
      <p class="text-xl text-slate-600 leading-relaxed max-w-2xl">
        Zapomnij o ręcznym przepisywaniu danych. Oferujemy <strong class="text-slate-900">usługi Power BI</strong> i <strong class="text-slate-900">automatyzację Excel</strong>, które zamieniają godziny pracy w sekundy.
      </p>
    </header>

    <div class="relative">
      <div 
        class="services-layout-wrapper" 
        x-ref="track"
        @scroll.debounce.50ms="activeStep = Math.round($refs.track.scrollLeft / ($refs.track.clientWidth * 0.85))"
      >
        
        <article class="service-item group">
          <div class="slide-content glass-card">
            <div class="slide-icon-wrapper">
              <i class="fas fa-chart-pie"></i>
              <div class="icon-glow"></div>
            </div>
            <h3 class="slide-title">Usługi Power BI</h3>
            <p class="slide-text">
              Projektujemy interaktywne dashboardy, które aktualizują się same. Tworzymy czytelne wskaźniki KPI dostępne na telefonie i komputerze.
            </p>
            <div class="pill-group">
              <span class="pill">Dashboardy 24/7</span>
              <span class="pill">DAX Optimization</span>
              <span class="pill">Cloud Reports</span>
            </div>
          </div>
        </article>

        <article class="service-item group">
          <div class="slide-content glass-card">
            <div class="slide-icon-wrapper">
              <i class="fas fa-file-excel"></i>
              <div class="icon-glow"></div>
            </div>
            <h3 class="slide-title">Tworzenie arkuszy Excel</h3>
            <p class="slide-text">
              Budujemy zaawansowane narzędzia "szyte na miarę". Od prostych tabel po rozbudowane systemy kalkulacyjne i <strong class="text-slate-700">automatyzację raportów</strong>.
            </p>
            <div class="pill-group">
              <span class="pill">Power Query</span>
              <span class="pill">Makra VBA</span>
              <span class="pill">Naprawa plików</span>
            </div>
          </div>
        </article>

        <article class="service-item group">
          <div class="slide-content glass-card">
            <div class="slide-icon-wrapper">
              <i class="fas fa-microchip"></i>
              <div class="icon-glow"></div>
            </div>
            <h3 class="slide-title">Analiza & Automatyzacja</h3>
            <p class="slide-text">
              Łączymy dane z wielu źródeł (SQL, API, ERP). Odkrywamy ukryte trendy i eliminujemy błędy ludzkie dzięki skryptom Python i SQL.
            </p>
            <div class="pill-group">
              <span class="pill">Big Data SQL</span>
              <span class="pill">Python Scripts</span>
              <span class="pill">ETL Processes</span>
            </div>
          </div>
        </article>

        <article class="service-item group">
          <div class="slide-content bg-slate-900 text-white border-transparent shadow-2xl shadow-slate-900/40 relative overflow-hidden">
            <div class="absolute -top-10 -right-10 w-32 h-32 bg-green-500/20 rounded-full blur-2xl"></div>
            
            <div class="slide-icon text-green-500 relative z-10" aria-hidden="true"><i class="fas fa-rocket"></i></div>
            <h3 class="slide-title text-white relative z-10">Naprawa & Konsultacje</h3>
            <p class="slide-text text-slate-400 relative z-10">
              Twój plik Excel wolno działa? Potrzebujesz nagłej pomocy w Power BI? Oferujemy ekspresową <strong class="text-white">naprawę plików Excel</strong> i doradztwo.
            </p>
            <div class="mt-auto pt-8 relative z-10">
              <a href="#kontakt" class="bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-xl text-sm font-bold inline-flex items-center gap-3 transition-all">
                Darmowa konsultacja 
                <i class="fas fa-chevron-right text-[10px]"></i>
              </a>
            </div>
          </div>
        </article>

      </div>

      <div class="flex justify-center gap-3 mt-12 lg:hidden">
        <template x-for="i in [0, 1, 2, 3]">
          <div 
            class="h-1.5 transition-all duration-500 rounded-full"
            :class="activeStep === i ? 'w-10 bg-green-600' : 'w-2 bg-slate-200'"
          ></div>
        </template>
      </div>
    </div>
  </div>
</section>

<style>
  .modern-services {
    padding: 120px 0;
    /* Tło ustawione na transparent, by widzieć kolor z body */
    background: transparent;
  }

  .services-layout-wrapper {
    display: flex;
    gap: 24px;
    overflow-x: auto;
    padding: 20px 0 40px 0;
    scroll-snap-type: x mandatory;
    scrollbar-width: none;
    -webkit-overflow-scrolling: touch;
  }

  .services-layout-wrapper::-webkit-scrollbar { display: none; }

  @media (min-width: 1024px) {
    .services-layout-wrapper {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 40px;
      overflow: visible;
    }
  }

  .service-item {
    flex: 0 0 85vw;
    scroll-snap-align: center;
    display: flex;
  }

  @media (min-width: 1024px) {
    .service-item { flex: none; width: 100%; }
  }

  /* GLASSMOPHISM EFFECT */
  .slide-content {
    padding: 50px;
    width: 100%;
    border-radius: 40px;
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.5);
    box-shadow: 0 10px 30px rgba(15, 23, 42, 0.03);
    transition: all 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
    display: flex;
    flex-direction: column;
  }

  .service-item:hover .slide-content {
    background: #ffffff;
    transform: translateY(-12px) scale(1.02);
    box-shadow: 0 40px 80px -20px rgba(15, 23, 42, 0.12);
    border-color: rgba(34, 197, 94, 0.3);
  }

  .slide-icon-wrapper {
    position: relative;
    width: fit-content;
    margin-bottom: 32px;
  }

  .slide-icon {
    font-size: 2.5rem;
    color: #14923b;
  }

  .icon-glow {
    position: absolute;
    inset: -10px;
    background: rgba(34, 197, 94, 0.2);
    border-radius: 50%;
    filter: blur(15px);
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .service-item:hover .icon-glow { opacity: 1; }

  .slide-title {
    font-size: 1.85rem;
    font-weight: 900;
    color: #0f172a;
    margin-bottom: 20px;
    letter-spacing: -0.03em;
  }

  .slide-text {
    font-size: 1.1rem;
    line-height: 1.7;
    color: #475569;
  }

  .pill-group {
    margin-top: auto;
    padding-top: 40px;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }

  .pill {
    font-size: 0.75rem;
    font-weight: 800;
    text-transform: uppercase;
    padding: 6px 14px;
    background: white;
    border: 1px solid #f1f5f9;
    color: #64748b;
    border-radius: 12px;
    transition: all 0.3s;
  }

  .service-item:hover .pill {
    border-color: #dcfce7;
    color: #166534;
  }
</style>